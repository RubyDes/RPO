**Дата:** 06 декабря 2025 г.

**Статус:** Принято

**Контекст:**

Курсы содержат большое количество видео и медиаконтента. Система должна:
- Загружать и хранить видео разных размеров и форматов
- Автоматически обрабатывать видео (создавать разные качество для разных скоростей интернета)
- Быстро показывать видео студентам без задержек
- Защищать видео от скачивания и распространения
- Работать с тысячами видеофайлов

**Рассмотренные варианты:**

1. **Самостоятельная обработка (FFmpeg на своих серверах)** – полный контроль, но сложно и дорого
2. **Облачные медиа-сервисы (AWS MediaConvert, GCP Transcoder)** – масштабируемо, но требует настройки
3. **Специализированные видео-платформы (Mux, api.video)** – очень просто, но зависит от внешнего сервиса
4. **Гибридный подход (хранение в облаке + своя обработка)** – баланс контроля и простоты

**Решение:**

Выбран **вариант 3: использование Mux как специализированной видео-платформы**.

**Обоснование:**

- **Простота интеграции** – Mux предоставляет готовое API, не нужно настраивать серверы. (Ускоряет разработку в рамках LIM03, соответствует PRN01)
- **Автоматическая обработка** – видео автоматически конвертируется в оптимальные форматы. (Обеспечивает производительность PER03)
- **Быстрая доставка** – CDN Mux обеспечивает быструю загрузку по всему миру. (Обеспечивает производительность PER03, соответствует PRN04)
- **Защита контента** – есть встроенные методы защиты от скачивания. (Обеспечивает SEC06)
- **Аналитика просмотров** – видно, как студенты смотрят видео (где останавливаются, пересматривают). (Позволяет собирать бизнес-метрики для MON01)
- **Масштабируемость** – автоматически справляется с нагрузкой. (Соответствует SCA01-SCA04)

**Технические детали:**

- **Процесс загрузки видео:**
  1. Преподаватель загружает видео через наш интерфейс
  2. Файл временно сохраняется на наш сервер
  3. Отправляется в Mux через их API
  4. Mux обрабатывает видео (создает 4-5 вариантов качества)
  5. Мы сохраняем ссылку на видео в нашей базе

- **Воспроизведение видео:**
  1. Студент открывает видео в курсе
  2. Наш плеер подключается к Mux Player
  3. Mux автоматически выбирает подходящее качество по скорости интернета
  4. Видео начинает играть почти сразу (2-3 секунды)

- **Защита контента:**
  - Подписанные URL (ссылки с ограниченным временем действия)
  - Гео-ограничения (только из России)
  - Referer проверка (только с нашего сайта)
  - DRM (опционально, для очень важных курсов)

**Последствия:**

- **Нужно сделать:**
  - Интегрировать Mux API с нашим бэкендом (Laravel)
  - Создать интерфейс загрузки видео для преподавателей
  - Настроить наш видеоплеер для работы с Mux
  - Реализовать проверку прав доступа к видео
  - Настроить мониторинг использования Mux

- **Положительные стороны:**
  - Быстрая реализация (не нужно строить свою инфраструктуру)
  - Высокое качество воспроизведения
  - Автоматическое обновление технологий
  - Готовая аналитика

- **Отрицательные стороны:**
  - Зависимость от внешнего сервиса
  - Постоянные расходы (оплата за минуты просмотра)
  - Нужно проверять соответствие 152-ФЗ (данные в России)
  - Меньше контроля над процессом